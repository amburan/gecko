units		real
atom_style	charge
# create domain
#lattice	type reduced density rho* = 4*(sigma/a)^3, where N=4 for fcc, s = 3.405 A (Wagner) and a = 5.25 A (Ashcroft & Mermin, p. 70)

lattice custom 1.0 origin 0.25 0.25 0.25 a1 4.44949060  0.00000000    0.00000000  a2 -2.22474530   3.85337190   0.00000000 a3 0.00000000  0.00000000  31.15087328 basis   0.000000  0.000000  0.399257 basis   0.666667  0.333333  0.732590 basis   0.333333  0.666667  0.065923 basis   0.000000  0.000000  0.600743 basis   0.666667  0.333333  0.934077 basis   0.333333  0.666667  0.267410 basis   0.000000  0.000000  0.211844  basis   0.666667  0.333333  0.545177 basis   0.333333  0.666667  0.878510 basis   0.000000  0.000000  0.000000 basis   0.666667  0.333333  0.333333 basis   0.333333  0.666667  0.666667 basis   0.000000  0.000000  0.788156 basis   0.666667  0.333333  0.121490 basis   0.333333  0.666667  0.454823

region		simRegion block 0 2 0 2 0 10
# create atoms, NOTE commented out for restart
region		mdRegion block 0 2 0 2 3 7
boundary	p p p
create_box	3 mdRegion
create_atoms 3 region mdRegion basis 1 1 basis 2 1 basis 3 1 basis 4 1 basis 5 1 basis 6 1 basis 7 2 basis 8 2 basis 9 2 basis 10 3 basis 11 3 basis 12 3 basis 13 2 basis 14 2 basis 15 2

mass            1 208.98
mass            2 127.60
mass            3 127.60

set             type 1 charge  0.38
set             type 2 charge -0.26
set             type 3 charge -0.24

kspace_style    ewald 1.0e-4
#kspace_modify slab nozforce

# specify interal/ghost atoms
region		mdInternal block 0 2 0 2 4 6
group		internal region mdInternal
group		ghost subtract all internal

pair_style      hybrid/overlay morse 5.5 coul/long 12
pair_coeff      1 1 morse 0.085  2.212  4.203  5.5
pair_coeff      1 2 morse 0.975  1.285  3.089  4.0
pair_coeff      1 3 morse 0.582  1.257  3.251  4.0
pair_coeff      2 2 morse 0.076  1.675  3.642  5.0
pair_coeff      2 3 morse 0.807  0.731  4.497  5.5
pair_coeff      3 3 morse 0.066  2.876  4.312  5.0
pair_coeff      * * coul/long

neighbor	5. bin
#neigh_modify	every 10 delay 0 check no



#MINIMIZATION
minimize 0.0 1.0e-8 1000 100000


#DYNAMIC EQUILIBRIATION

# velocities have Vcm = 0, NOTE next four lines commented out for restart
velocity	internal create 40. 87287 mom yes loop geom
variable xdof equal 3*count(ghost)
compute_modify thermo_temp extra ${xdof}
thermo_style custom step cpu etotal pe temp
thermo_modify  format 1 %6i format 2 %7.2g
# equilibrate MD field
#fix_modify      AtC  output bar1dfe_flux_init 100
dump            D3 all atom 10 dump.bar1d
timestep	5
thermo		10
run 		100

#PRODUCTION
#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc thermal     Bi2Te3_thermal.mat
fix_modify      AtC boundary ghost
fix_modify      AtC time_integration fractional_step
#               ID  part keywords    nx ny nz region
fix_modify      AtC mesh create 2 2 10  simRegion p p p
# fix a temperature
fix_modify     	AtC  fix temperature all 40.
# turn on thermostat
fix_modify	AtC  control thermal rescale 10
dump            D4 all atom 100 dump.equilibrium
timestep	1
thermo		10
run 		10000


# change thermostat to hoover
fix_modify	AtC  unfix temperature all
fix_modify	AtC  control thermal none
fix_modify	AtC  control thermal flux interpolate
fix_modify AtC control max_iterations 100
fix_modify AtC control tolerance 1.e-6

#fix_modify	AtC  control localized_lambda on
#fix_modify	AtC  thermal control flux faceset obndy
fix_modify      AtC  filter type exponential
fix_modify	AtC  filter scale 10000.0
#fix_modify	AtC  filter on


# add nodesets
#               ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify      AtC mesh create_nodeset tbc -INF INF -INF INF 9.8 10.2
fix_modify      AtC mesh create_nodeset bbc -INF INF -INF INF -0.2 1.2

# set up output, should be before a "run"
fix_modify      AtC  output bar1d_fluxFE 100 text binary
# ouput command
dump            D1 all atom 1 dump.production
# run with FE
reset_timestep 0
timestep	1
thermo		100

fix_modify      AtC  fix temperature tbc 45
fix_modify      AtC  fix temperature bbc 40
run 		1000
