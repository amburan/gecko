units       real
atom_style	charge
variable    T equal 300
variable    V equal vol
variable    dt equal 0.25
variable    p equal 200     # correlation length
variable    s equal 10      # sample interval
variable    d equal $p*$s   # dump interval

variable    kB equal 1.3806504e-23    # [J/K] Boltzmann
variable    kCal2J equal 4186.0/6.02214e23
variable    A2m equal 1.0e-10
variable    fs2s equal 1.0e-15
variable    convert equal ${kCal2J}*${kCal2J}/${fs2s}/${A2m}


dimension    3
boundary     p p p
lattice custom 1.0 origin 0.35 0.35 0.35 a1 4.44949060  0.00000000    0.00000000  a2 -2.22474530   3.85337190   0.00000000 a3 0.00000000  0.00000000  31.15087328 basis   0.000000  0.000000  0.399257 basis   0.666667  0.333333  0.732590 basis   0.333333  0.666667  0.065923 basis   0.000000  0.000000  0.600743 basis   0.666667  0.333333  0.934077 basis   0.333333  0.666667  0.267410 basis   0.000000  0.000000  0.211844  basis   0.666667  0.333333  0.545177 basis   0.333333  0.666667  0.878510 basis   0.000000  0.000000  0.000000 basis   0.666667  0.333333  0.333333 basis   0.333333  0.666667  0.666667 basis   0.000000  0.000000  0.788156 basis   0.666667  0.333333  0.121490 basis   0.333333  0.666667  0.454823
region       box block 0 4 0 4 0 10
create_box   3 box
create_atoms 3 box
mass            1 208.98
mass            2 127.60
mass            3 127.60
set             type 1 charge  0.38
set             type 2 charge -0.26
set             type 3 charge -0.24

kspace_style    ewald 1.0e-4
#kspace_modify slab nozforce
pair_style      hybrid/overlay morse 5.5 coul/long 12
pair_coeff      1 1 morse 0.085  2.212  4.203  5.5
pair_coeff      1 2 morse 0.975  1.285  3.089  4.0
pair_coeff      1 3 morse 0.582  1.257  3.251  4.0
pair_coeff      2 2 morse 0.076  1.675  3.642  5.0
pair_coeff      2 3 morse 0.807  0.731  4.497  5.5
pair_coeff      3 3 morse 0.066  2.876  4.312  5.0
pair_coeff      * * coul/long

timestep     ${dt}
thermo            $d

#MINIMIZATION
minimize 0.0 1.0e-8 1000 100000

thermo_modify lost ignore flush yes

velocity     all create $T 102486 mom yes rot yes dist gaussian
fix          NVT all nvt temp $T $T 10 drag 0.2
run          800


reset_timestep 0
compute      myKE all ke/atom
compute      myPE all pe/atom
compute      myStress all stress/atom NULL virial
compute      flux all heat/flux myKE myPE myStress
variable     Jx equal c_flux[1]/vol
variable     Jy equal c_flux[2]/vol
variable     Jz equal c_flux[3]/vol
fix          JJ all ave/correlate $s $p $d &
             c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
variable     scale equal ${convert}/${kB}/$T/$T/$V*$s*${dt}
variable     k11 equal trap(f_JJ[3])*${scale}
variable     k22 equal trap(f_JJ[4])*${scale}
variable     k33 equal trap(f_JJ[5])*${scale}
thermo_style custom step temp v_Jx v_Jy v_Jz v_k11 v_k22 v_k33
thermo_modify lost ignore flush yes
dump            D1 all atom 1000 dump.k_calc_production
run          1000000


variable     k equal (v_k11+v_k22+v_k33)/3.0
variable     ndens equal count(all)/vol
print        "average conductivity: $k[W/mK] @ $T K, ${ndens} /A^3"
